/**
* O3 video player
*
* Cross browser javascript video player
* Released under the MIT license
*
* @author Zoltan Fischer 
* @license https://github.com/zoli-fischer/o3-video/blob/master/LICENSE
*/

o3video_config={no_support_msg:"Your web browser does not support the video tag or missing the codec for this video file.",script_uri:function(){var e=document.getElementsByTagName("script");for(var t=e.length-1;t>=0;t--){if(e[t].src&&e[t].src.indexOf("o3-video")!=-1){if(e[t].src.match(/^(http.+\/)[^\/]+$/)&&e[t].src.match(/^(http.+\/)[^\/]+$/).length>0)return e[t].src.match(/^(http.+\/)[^\/]+$/)[1];return e[t].src.substring(0,e[t].src.lastIndexOf("/")+1)}}return""}()};o3video=function(e,t){var n=this;var r=jQuery;n.opts=r.extend({playButtonImage:"data:image/png;base64,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"},e);n.$container=r(t);n.container=n.$container.get(0);if(n.$container.length!=1||!n.container)return console.log("O3 Video: Container must not be empty!")||false;if(n.$container.prop("tagName").toString().toUpperCase()!="VIDEO")return console.log("O3 Video: Container's tagname is not video.")||false;n.type="";n.$div=null;n.$div_vid=null;n.$div_main=null;n.$playbtn=null;n.$no_support_msg=null;n.source=new Array;n.codec_exists=false;n.flash_exists=false;n.flash_name="";n.flash_src="";n.origin={controls:/ controls/i.test(n.container.outerHTML),height:n.get_prop(n.$container,"height","auto"),loop:n.get_prop(n.$container,"loop",false),muted:/ muted/i.test(n.container.outerHTML),autoplay:/ autoplay/i.test(n.container.outerHTML),poster:n.get_prop(n.$container,"poster",""),preload:n.get_prop(n.$container,"preload",false),src:n.get_prop(n.$container,"src",""),style:n.get_prop(n.$container,"style"),width:n.get_prop(n.$container,"width","auto"),height:n.get_prop(n.$container,"height","auto"),innerHTML:n.get_prop(n.$container,"innerHTML","")};n.constructor__=function(){n.$div=r("<div></div>").insertAfter(n.$container).attr({id:n.$container.prop("id"),style:n.$container.attr("style"),"class":n.$container.attr("class")}).css({display:n.$container.css("display")=="inline"?"inline-block":n.$container.css("display"),width:n.origin.style&&n.origin.style.width!=""?n.origin.style.width:n.origin.width,height:n.origin.style&&n.origin.style.height!=""?n.origin.style.height:n.origin.height});if(n.origin.src!=""){if(n.origin.src!=""&&n.ext2mime(n.origin.src)!="")n.source.push({src:n.origin.src,type:n.ext2mime(n.origin.src),has_codec:n.is_codec_video(n.ext2mime(n.origin.src))});if(n.ext2mime(n.origin.src)=="video/mp4"&&n.flash_src=="")n.flash_src=n.origin.src}n.$container.find("source").each(function(){var e=n.get_prop(r(this),"src",""),t=n.get_prop(r(this),"type",n.ext2mime(e)),i=n.is_codec_video(t);if(i)n.codec_exists=true;if(e!=""&&t!="")n.source.push({src:e,type:t,has_codec:i});r(this).remove();if(t=="video/mp4"&&n.flash_src=="")n.flash_src=e});var e=n.get_prop(n.$container,"innerHTML","");e=r.trim(e).length==0?o3video_config.no_support_msg:e;if(/MSIE/i.test(navigator.userAgent)&&parseFloat((navigator.userAgent.toLowerCase().match(/.*(?:rv|ie)[\/: ](.+?)([ \);]|$)/)||[])[1])<9){var t=n.container,i=[];while(t.nextSibling&&t.nextSibling.tagName!="/VIDEO"){t=t.nextSibling;if(t.tagName=="SOURCE"){if(n.ext2mime(t.src)=="video/mp4"&&n.flash_src=="")n.flash_src=t.src;if(!/^(?:[a-z]+:)?\/\//i.test(n.flash_src))n.flash_src=window.location.protocol+"//"+window.location.hostname+window.location.pathname+n.flash_src}if(t.tagName!="DIV")i.push(t)}t=t.nextSibling;if(t.tagName=="/VIDEO")i.push(t);for(var s=0;s<i.length;s++)r(i[s]).remove()}n.addCSS2Head();var o='<div class="o3-video-fill_wnd o3-video-main">						 	<a href="javascript:{}" class="o3-video-playbtn o3-video-transition"></a>						 	<div class="o3-video-no_support_msg o3-video-transition o3-video-fill_wnd o3-video-absolute">'+e+"</div>						 </div>";n.$div.html(o);n.$div_main=n.$div.find(".o3-video-main");var u=n.container.style.zIndex;n.$playbtn=n.$div.find(".o3-video-playbtn").css("z-index",u!="auto"?parseInt(u)+100:1);n.$no_support_msg=n.$div.find(".o3-video-no_support_msg");n.create_playbtn();if(n.codec_exists){n.create_video()}else{this.$playbtn.css("display","none");n.flash_exists=n.get_flash_version().split(",").shift();if(n.flash_exists>=9&&n.flash_src!=""){n.create_flash()}else{n.$no_support_msg.css("display","block")}}n.$container.attr("src","");if(typeof n.container.pause=="function")n.container.pause();n.$container.remove()};n.constructor__()};o3video.prototype.hideOverlayPlayBtn=function(e){e=typeof e=="undefined"?true:e;if(e){var t=this.$playbtn.addClass("o3-video-playbtn_hide");setTimeout(function(){t.css("display","none")},300)}else{this.$playbtn.css("display","block").removeClass("o3-video-playbtn_hide")}};o3video.prototype.play=function(){if(this.type=="html5"){this.$div_vid.get(0).play()}else{this.get_flash_ref().play()}};o3video.prototype.pause=function(){if(this.type=="html5"){this.$div_vid.get(0).pause()}else{this.get_flash_ref().pause()}};o3video.prototype.create_playbtn=function(){if(this.origin.autoplay||/firefox/i.test(navigator.userAgent)||/Nintendo/i.test(navigator.userAgent)||/iPod/i.test(navigator.userAgent)||/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent)||/Windows Phone/i.test(navigator.userAgent)||/Android/i.test(navigator.userAgent)){this.$playbtn.css("display","none")}else{this.$playbtn.css("display","block")}var e=this;this.$playbtn.click(function(){e.play()})};o3video.prototype.addCSS2Head=function(){if(jQuery('style[ref="o3-video-classes"]').length==0)jQuery("head").prepend('<style type="text/css" ref="o3-video-classes">'+".o3-video-transition { -moz-transition: all 0.3s linear; -webkit-transition: all 0.3s linear; -o-transition: all 0.3s linear; transition: all 0.3s linear; } "+".o3-video-fill_wnd { display: block; position: relative; left: 0px; top: 0px; width: 100%; height: 100%; overflow: hidden; } "+".o3-video-absolute { position: absolute; } "+".o3-video-playbtn { opacity: 1; visibility: visible; z-index: 10; pointer: cursor; position: absolute; left: 50%; right: 50%; top: 50%; bottom: 50%; margin-left: -46px; margin-top: -46px;  width: 93px; height: 94px; display: block; background-image: url("+this.opts.playButtonImage+"); background-position: center; background-repeat: no-repeat; -moz-transition: all 0.2s ease-in; -webkit-transition: all 0.2s ease-in; -o-transition: all 0.2s ease-in; transition: all 0.2s ease-in; border-radius: 45px; -webkit-border-radius: 45px; -moz-border-radius: 45px; }"+".o3-video-playbtn:hover { opacity: 0.6 }"+".o3-video-playbtn_hide { visibility: hidden; opacity: 0; -ms-transform: scale(2,2); -webkit-transform: scale(2,2); transform: scale(2,2); }"+".o3-video-no_support_msg { display: none; font-size: 14px; color: #000000; font-family: sans-serif; background: #FFFFFF; text-align: center; padding: 20px 0px 0px 0px; }"+"</style>")};o3video.prototype.get_flash_ref=function(){var e=typeof document[this.flash_name+"_obj"]!=undefined?document[this.flash_name+"_obj"]:window[this.flash_name+"_obj"],t=typeof document[this.flash_name+"_embed"]!=undefined?document[this.flash_name+"_embed"]:window[this.flash_name+"_embed"];return t?t:e};o3video.prototype.create_flash=function(){this.type="flash";var e="src="+this.flash_src+"&autoplay="+(this.origin.autoplay?"true":"false")+"&loop="+(this.origin.loop?"true":"false")+"&muted="+(this.origin.muted?"true":"false")+"&controls="+(this.origin.controls?"true":"false")+"&poster="+this.origin.poster.replace(/\+/g,"%2B")+"&playButtonImage="+this.opts.playButtonImage.replace(/\+/g,"%2B");this.flash_name="o3f"+Math.random().toString().replace(".","");jQuery('<object name="'+this.flash_name+'_obj" id="'+this.flash_name+'_obj" width="100%" height="100%">'+'<param name="movie" value="'+o3video_config.script_uri+"o3-video.flash.swf?"+Math.random()+'"></param>'+'<param name="flashvars" value="'+e+'"></param>'+'<param name="allowFullScreen" value="true"></param>'+'<param name="allowscriptaccess" value="always"></param>'+'<param name="quality" value="hight"></param>'+'<param name="wmode" value="transparent"></param>'+'<param name="menu" value="true"></param>'+'<embed name="'+this.flash_name+'_embed" id="'+this.flash_name+'_embed"  src="'+o3video_config.script_uri+"o3-video.flash.swf?"+Math.random()+'" type="application/x-shockwave-flash" allowscriptaccess="always"'+'wmode="transparent" menu="true" quality="high" allowfullscreen="true" width="100%" height="100%" flashvars="'+e+'"></embed>'+"</object>").appendTo(this.$div_main)};o3video.prototype.create_video=function(){var e=this;this.type="html5";this.$div_vid=jQuery('<video id="video" width="100%" height="100%"'+(this.origin.autoplay?' autoplay="autoplay" ':"")+(this.origin.controls?" controls ":"")+(this.origin.loop?" loop ":"")+(this.origin.muted?" muted ":"")+(this.origin.poster?' poster="'+this.origin.poster+'" ':"")+(this.origin.preload?' preload="'+(this.origin.preload?"true":"false")+'" ':"")+" >"+this.origin.innerHTML+"</video>").appendTo(this.$div_main);if(typeof this.$div_vid.get(0).load=="function")this.$div_vid.get(0).load();if(this.origin.poster){this.$div_vid.get(0).poster="";this.$div_vid.get(0).poster=this.origin.poster}this.$div_vid.bind("playing",function(){e.hideOverlayPlayBtn()})};o3video.prototype.is_codec_video=function(e){if(!!document.createElement("video").canPlayType){var t=document.createElement("video");switch(e){case"video/mp4":return t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');case"video/webm":return t.canPlayType('video/webm; codecs="vp8.0, vorbis"');case"video/ogg":return t.canPlayType('video/ogg; codecs="theora, vorbis"')}}return false};o3video.prototype.get_flash_version=function(){try{try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{e.AllowScriptAccess="always"}catch(t){return"6,0,0"}}catch(t){}return(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(t){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}}catch(t){}}return"0,0,0"};o3video.prototype.ext2mime=function(e){var t=/(?:\.([^./]+))?$/.exec(e)[1];t=typeof t!="undefined"?t.toLowerCase():false;return t&&t.indexOf(["mp4","webm","ogg"])?"video/"+t:false};o3video.prototype.get_prop=function(e,t,n){return e.prop(t)?e.prop(t):n};console=typeof console!="undefined"?console:{log:function(){}};if(typeof jQuery!="undefined"){jQuery.fn.o3video=function(e){if(jQuery(this).length==0)return console.log("O3 Video: Container must not be empty!")||false;jQuery(this).each(function(){new o3video(e,this)});return this}}else{console.log("O3 Video: jQuery missing!")}